Arquivo: configurar_sysfit_agent.ps1
# ====================================
# Configurar SysFit Agent - Auto-Start
# ====================================

Write-Host "üöÄ Configurando SysFit Agent para auto-start..." -ForegroundColor Cyan
Write-Host ""

# Ir para o diret√≥rio
cd C:\SysFit\agent

# Limpar PM2 (se j√° existir)
pm2 delete all

# Iniciar com PM2
pm2 start agent.js --name "sysfit-agent"

# Salvar configura√ß√£o para auto-start
pm2 save

# Verificar status
Write-Host ""
Write-Host "üìä Status:" -ForegroundColor Yellow
pm2 list

Write-Host ""
Write-Host "‚úÖ SysFit Agent configurado para iniciar automaticamente!" -ForegroundColor Green

_________________________________________________________________________________________________

Arquivo: configurar_toletus_hub.ps1
# ====================================
# Configurar Toletus Hub - Auto-Start
# EXECUTAR COMO ADMINISTRADOR
# ====================================

Write-Host "üöÄ Configurando Toletus Hub para auto-start..." -ForegroundColor Cyan
Write-Host ""

# 1. Criar script BAT para iniciar o Toletus Hub
Write-Host "üìù Criando script de inicializa√ß√£o..." -ForegroundColor Yellow
$batContent = @'
@echo off
cd /d C:\SysFit\agent\hub-main\src\Toletus.Hub.API
dotnet run --urls "https://localhost:7067"
'@

Set-Content -Path "C:\SysFit\agent\START_TOLETUS_HUB.bat" -Value $batContent

# 2. Criar VBScript para executar invis√≠vel (sem janela)
Write-Host "üîí Criando launcher invis√≠vel..." -ForegroundColor Yellow
$vbsContent = @'
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "C:\SysFit\agent\START_TOLETUS_HUB.bat", 0, False
'@

Set-Content -Path "C:\SysFit\agent\START_TOLETUS_INVISIBLE.vbs" -Value $vbsContent

# 3. Remover tarefa antiga se existir
Write-Host "üóëÔ∏è Removendo configura√ß√µes antigas..." -ForegroundColor Yellow
Unregister-ScheduledTask -TaskName "Toletus Hub AutoStart" -Confirm:$false -ErrorAction SilentlyContinue

# 4. Criar tarefa agendada para auto-start
Write-Host "‚öôÔ∏è Criando tarefa agendada..." -ForegroundColor Yellow
$action = New-ScheduledTaskAction -Execute "wscript.exe" -Argument '"C:\SysFit\agent\START_TOLETUS_INVISIBLE.vbs"' -WorkingDirectory "C:\SysFit\agent"

$trigger = New-ScheduledTaskTrigger -AtStartup

$principal = New-ScheduledTaskPrincipal -UserId "SYSTEM" -LogonType ServiceAccount -RunLevel Highest

$settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -ExecutionTimeLimit 0

Register-ScheduledTask -TaskName "Toletus Hub AutoStart" -Action $action -Trigger $trigger -Principal $principal -Settings $settings -Description "Inicia o Toletus Hub automaticamente no boot"

# 5. Verificar
Write-Host ""
Write-Host "üìä Status da tarefa:" -ForegroundColor Yellow
Get-ScheduledTask -TaskName "Toletus Hub AutoStart"

Write-Host ""
Write-Host "‚úÖ Toletus Hub configurado para iniciar automaticamente!" -ForegroundColor Green

__________________________________________________________________________________________________

Arquivo: verificar_servicos.ps1
# ====================================
# Verificar Status dos Servi√ßos
# ====================================

Write-Host "======================================" -ForegroundColor Cyan
Write-Host "üìä VERIFICA√á√ÉO DE SERVI√áOS" -ForegroundColor Cyan
Write-Host "======================================" -ForegroundColor Cyan
Write-Host ""

Write-Host "1Ô∏è‚É£ SysFit Agent (PM2):" -ForegroundColor Yellow
pm2 list

Write-Host ""
Write-Host "2Ô∏è‚É£ Toletus Hub:" -ForegroundColor Yellow
Get-Process -Name "Toletus.Hub.API" -ErrorAction SilentlyContinue | Select-Object Id, ProcessName, StartTime, @{Name="Memory(MB)";Expression={[math]::Round($_.WorkingSet64 / 1MB, 2)}}

Write-Host ""
Write-Host "3Ô∏è‚É£ Tarefa Agendada:" -ForegroundColor Yellow
Get-ScheduledTask -TaskName "Toletus Hub AutoStart" -ErrorAction SilentlyContinue | Select-Object TaskName, State

Write-Host ""
Write-Host "4Ô∏è‚É£ Teste de Conectividade (Porta 7067):" -ForegroundColor Yellow
Test-NetConnection -ComputerName localhost -Port 7067 -WarningAction SilentlyContinue | Select-Object RemotePort, TcpTestSucceeded

Write-Host ""
Write-Host "======================================" -ForegroundColor Cyan

_________________________________________________________________________________________________________________________________

Arquivo: parar_servicos.ps1
# ====================================
# Parar Todos os Servi√ßos
# ====================================

Write-Host "üõë Parando todos os servi√ßos..." -ForegroundColor Yellow
Write-Host ""

# 1. Parar PM2
Write-Host "1Ô∏è‚É£ Parando SysFit Agent (PM2)..." -ForegroundColor Cyan
pm2 stop all

# 2. Matar Toletus Hub
Write-Host "2Ô∏è‚É£ Parando Toletus Hub..." -ForegroundColor Cyan
Get-Process -Name "Toletus.Hub.API" -ErrorAction SilentlyContinue | Stop-Process -Force

# 3. Verificar
Write-Host ""
Write-Host "‚úÖ Verificando processos..." -ForegroundColor Green
Write-Host ""
pm2 list
Get-Process -Name "Toletus.Hub.API" -ErrorAction SilentlyContinue

Write-Host ""
Write-Host "üéØ Servi√ßos parados!" -ForegroundColor Green
5Ô∏è‚É£ Reiniciar Todos os Servi√ßos
Arquivo: reiniciar_servicos.ps1
# ====================================
# Reiniciar Todos os Servi√ßos
# ====================================

Write-Host "üîÑ Reiniciando todos os servi√ßos..." -ForegroundColor Cyan
Write-Host ""

# 1. Reiniciar SysFit Agent
Write-Host "1Ô∏è‚É£ Reiniciando SysFit Agent..." -ForegroundColor Yellow
pm2 restart sysfit-agent

# 2. Reiniciar Toletus Hub
Write-Host "2Ô∏è‚É£ Reiniciando Toletus Hub..." -ForegroundColor Yellow
Get-Process -Name "Toletus.Hub.API" -ErrorAction SilentlyContinue | Stop-Process -Force
Start-Sleep -Seconds 3
Start-ScheduledTask -TaskName "Toletus Hub AutoStart"

# 3. Aguardar
Write-Host ""
Write-Host "‚è≥ Aguardando servi√ßos iniciarem..." -ForegroundColor Yellow
Start-Sleep -Seconds 10

# 4. Verificar
Write-Host ""
Write-Host "‚úÖ Verificando status..." -ForegroundColor Green
pm2 list
Get-Process -Name "Toletus.Hub.API" -ErrorAction SilentlyContinue
Test-NetConnection -ComputerName localhost -Port 7067 -WarningAction SilentlyContinue | Select-Object TcpTestSucceeded

Write-Host ""
Write-Host "üéØ Servi√ßos reiniciados!" -ForegroundColor Green
6Ô∏è‚É£ Ver Logs do SysFit Agent
Arquivo: ver_logs_agent.ps1
# ====================================
# Ver Logs do SysFit Agent
# ====================================

Write-Host "üìã Logs do SysFit Agent:" -ForegroundColor Cyan
Write-Host ""

pm2 logs sysfit-agent --lines 50